{"version":3,"sources":["components/UserList/index.module.css","components/MessageList/index.module.css","components/Message/index.module.css","components/FileInput/index.module.css","components/UserHeader/index.module.css","components/CreateMessageForm/index.module.css","components/RoomList/index.module.css","components/RoomHeader/index.module.css","components/CreateRoomForm/index.module.css","components/WelcomeScreen/index.module.css","components/JoinRoomScreen/index.module.css","components/TypingIndicator/index.module.css","components/UserHeader/index.js","components/UserList/index.js","components/Message/index.js","components/MessageList/index.js","components/TypingIndicator/index.js","components/FileInput/index.js","components/CreateMessageForm/index.js","components/RoomList/index.js","components/RoomHeader/index.js","components/CreateRoomForm/index.js","components/WelcomeScreen/index.js","components/JoinRoomScreen/index.js","chatkit.js","history.js","auth/auth.js","index.js"],"names":["module","exports","component","online","empty","container","pulse","dots","ball-beat","UserHeader","_ref","_ref$user","user","react_default","a","createElement","className","style","src","avatarURL","alt","name","id","concat","UserList","room","createConvo","current","removeUser","users","map","key","presence","state","onClick","e","order","Attachment","fetchURL","_this","props","fetchAttachment","url","link","then","fetched","setState","file","this","setInterval","image","controls","video","audio","href","download","type","React","Component","Message","message","sender","string","date","Date","minutes","getMinutes","getHours","time","createdAt","Linkify_default","properties","target","text","attachment","Message_Attachment","emptyList","role","aria-label","MessageList","_ref$messages","messages","Object","keys","length","reverse","k","x","TypingIndicator","_ref$typing","typing","slice","join","FileInput","_ref$state","xlinkHref","onChange","files","sendMessage","roomId","replace","CreateMessageForm","_ref$state$user","_ref$state$room","_ref$state$message","runCommand","actions","onSubmit","preventDefault","value","startsWith","placeholder","onInput","isTypingIn","FileInput_FileInput","unreads","arguments","undefined","read","readCursor","filter","position","RoomList","_ref$rooms","rooms","messageKeys","latestMessage","pop","firstUser","find","unreadMessages","lastMessage","parseInt","priority","unreadCount","disabled","joinRoom","match","isPrivate","RoomHeader","sidebarOpen","userListOpen","_ref$actions","setSidebar","setUserList","CreateRoomForm","submit","private","elements","checked","WelcomeScreen","viewBox","d","JoinRoomScreen","instanceLocator","accessToken","createHistory","Auth","classCallCheck","auth0","WebAuth","domain","clientID","redirectUri","responseType","scope","login","bind","logout","handleAuthentication","isAuthenticated","getAuthToken","getUserId","callback","parseHash","err","authResult","idToken","setSession","email","history","console","log","alert","error","expiresAt","JSON","stringify","expiresIn","getTime","localStorage","setItem","jwtdecode","removeItem","parse","getItem","authorize","Main","window","innerWidth","setUser","setRoom","scrollToEnd","removeRoom","subscribeToRoom","setCursor","roomSubscriptions","hooks","onMessage","addMessage","createRoom","options","exists","addUserIds","addUserToRoom","userId","_ref$roomId","removeUserFromRoom","_ref2","_ref2$roomId","leaveRoom","setReadCursor","forceUpdate","payload","messageId","set","showNotification","command","commands","invite","_ref3","slicedToArray","remove","_ref5","leave","_ref7","split","args","exec","catch","setTimeout","elem","document","querySelector","scrollTop","isTyping","notTyping","del","setUserPresence","senderId","visibilityState","Notification","body","icon","addEventListener","focus","auth","requestPermission","ChatManager","tokenProvider","TokenProvider","connect","onUserStartedTyping","onUserStoppedTyping","onAddedToRoom","onRemovedFromRoom","onUserCameOnline","onUserWentOffline","Promise","all","_this$state","_this$actions","data-open","UserHeader_UserHeader","RoomList_RoomList","CreateRoomForm_CreateRoomForm","RoomHeader_RoomHeader","MessageList_MessageList","TypingIndicator_TypingIndicator","CreateMessageForm_CreateMessageForm","UserList_UserList","JoinRoomScreen_JoinRoomScreen","WelcomeScreen_WelcomeScreen","Callback","display","justifyContent","height","width","top","bottom","left","right","backgroundColor","_ref9","location","test","hash","makeMainRoutes","Router","Route","path","render","src_Main","assign","src_Callback","routes","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.ee7d04af.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"component\":\"UserList_component__3wRjv\",\"online\":\"UserList_online__34X0u\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"component\":\"MessageList_component__38GGZ\",\"empty\":\"MessageList_empty__2fgfw\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"component\":\"Message_component__3-DsD\",\"online\":\"Message_online__3QiE_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"FileInput_container___tE11\",\"component\":\"FileInput_component__13FhR\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"component\":\"UserHeader_component__14mC3\",\"pulse\":\"UserHeader_pulse__2gTzf\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"component\":\"CreateMessageForm_component__3S1hD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"component\":\"RoomList_component__2734B\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"component\":\"RoomHeader_component__2Xs8F\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"component\":\"CreateRoomForm_component__3qxlM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"component\":\"WelcomeScreen_component__2O8DZ\",\"pulse\":\"WelcomeScreen_pulse__QGuDP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"component\":\"JoinRoomScreen_component__3uiTn\",\"pulse\":\"JoinRoomScreen_pulse__2ZHKw\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"component\":\"TypingIndicator_component__zJe-E\",\"dots\":\"TypingIndicator_dots__fwZnf\",\"ball-beat\":\"TypingIndicator_ball-beat__-PO6d\"};","import React from 'react'\nimport style from './index.module.css'\n\nconst placeholder =\n  'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'\n\nexport const UserHeader = ({ user = {} }) => (\n  <header className={style.component}>\n    <img src={user.avatarURL || placeholder} alt={user.name} />\n    <div>\n      <h3>{user.name}</h3>\n      <h5>{user.id && `@${user.id}`}</h5>\n    </div>\n  </header>\n)\n","import React from 'react'\nimport style from './index.module.css'\n\nexport const UserList = ({ room, current, createConvo, removeUser }) => (\n  <ul className={style.component}>\n    {room.users.map(user => (\n      <li\n        key={user.id}\n        className={user.presence.state === 'online' ? style.online : null}\n        onClick={e => createConvo({ user })}\n        style={{ order: user.presence.state === 'online' && -1 }}\n      >\n        <img src={user.avatarURL} alt={user.name} />\n        <p>{user.name}</p>\n      </li>\n    ))}\n  </ul>\n)\n","import React from 'react'\nimport style from './index.module.css'\nimport Linkify from 'react-linkify'\n\nconst time = string => {\n  const date = new Date(string)\n  const minutes = date.getMinutes()\n  return `${date.getHours()}:${minutes < 10 ? '0' + minutes : minutes}`\n}\n\nclass Attachment extends React.Component {\n  fetchURL = () =>\n    this.props.user\n      .fetchAttachment({ url: this.props.link })\n      .then(fetched =>\n        this.setState({ src: fetched.link, name: fetched.file.name })\n      )\n  componentDidMount() {\n    this.props.link && setInterval(this.fetchURL, 1000 * 60, this.fetchURL())\n  }\n  render() {\n    return this.state\n      ? {\n          image: (\n            <img controls={true} src={this.state.src} alt={this.state.name} />\n          ),\n          video: <video controls={true} src={this.state.src} />,\n          audio: <audio controls={true} src={this.state.src} />,\n          file: (\n            <a href={this.state.src} download>\n              Download File\n            </a>\n          ),\n        }[this.props.type]\n      : null\n  }\n}\n\nexport const Message = ({ user, createConvo }) => message =>\n  message.sender ? (\n    <li key={message.id} className={style.component}>\n      <img\n        onClick={e => createConvo({ user: message.sender })}\n        src={message.sender.avatarURL}\n        alt={message.sender.name}\n      />\n      <div>\n        <span\n          className={\n            message.sender.id === user.id ||\n            (message.sender.presence &&\n              message.sender.presence.state === 'online')\n              ? style.online\n              : null\n          }\n        >{`${message.sender.name} | ${time(message.createdAt)}`}</span>\n        <p>\n          <Linkify properties={{ target: '_blank' }}>{message.text}</Linkify>\n        </p>\n        {message.attachment ? (\n          <Attachment\n            user={user}\n            link={message.attachment.link}\n            type={message.attachment.type}\n          />\n        ) : null}\n      </div>\n    </li>\n  ) : null\n","import React from 'react'\nimport style from './index.module.css'\nimport { Message } from '../Message'\n\nconst emptyList = (\n  <div className={style.empty}>\n    <span role=\"img\" aria-label=\"post\">\n      📝\n    </span>\n    <h2>No Messages Yet</h2>\n    <p>Be the first to post in this room or invite someone to join the room</p>\n  </div>\n)\n\nexport const MessageList = ({ messages = {}, user, createConvo }) => (\n  <ul id=\"messages\" className={style.component}>\n    {Object.keys(messages).length > 0 ? (\n      <wrapper->\n        {Object.keys(messages)\n          .reverse()\n          .map(k => Message({ user, createConvo })(messages[k]))}\n      </wrapper->\n    ) : (\n      emptyList\n    )}\n  </ul>\n)\n","import React from 'react'\nimport style from './index.module.css'\n\nconst dots = (\n  <div className={style.dots}>{[0, 1, 2].map(x => <div key={x} />)}</div>\n)\n\nexport const TypingIndicator = ({ typing = {} }) =>\n  Object.keys(typing).length ? (\n    <div className={style.component}>\n      <div>{dots}</div>\n      <div>{`${Object.keys(typing)\n        .slice(0, 2)\n        .join(' and ')} is typing`}</div>\n    </div>\n  ) : null\n","import React from 'react'\nimport style from './index.module.css'\n\nexport const FileInput = ({ state: { user, message, room } }) =>\n  room.id ? (\n    <div className={style.container}>\n      <svg>\n        <use xlinkHref=\"index.svg#attach\" />\n      </svg>\n      <input\n        className={style.component}\n        type=\"file\"\n        onChange={e => {\n          const file = e.target.files[0]\n          file &&\n            user.sendMessage({\n              text: message || file.name,\n              roomId: room.id,\n              attachment: {\n                name: file.name.replace(/[^A-Za-z0-9._-]/g, '--'),\n                file,\n              },\n            })\n        }}\n      />\n    </div>\n  ) : null\n","import React from 'react'\nimport style from './index.module.css'\nimport { FileInput } from '../FileInput'\n\nexport const CreateMessageForm = ({\n  state: { user = {}, room = {}, message = '' },\n  actions: { runCommand },\n}) =>\n  room.id ? (\n    <form\n      className={style.component}\n      onSubmit={e => {\n        e.preventDefault()\n        const message = e.target[0].value\n        e.target[0].value = ''\n        message.startsWith('/')\n          ? runCommand(message.slice(1))\n          : message.length > 0 &&\n            user.sendMessage({\n              text: message,\n              roomId: room.id,\n            })\n      }}\n    >\n      <input\n        placeholder=\"Type a Message..\"\n        onInput={e => user.isTypingIn({ roomId: room.id })}\n      />\n      <FileInput state={{ user, room, message }} />\n      <button type=\"submit\">\n        <svg>\n          <use xlinkHref=\"index.svg#send\" />\n        </svg>\n      </button>\n    </form>\n  ) : null\n","import React from 'react'\nimport style from './index.module.css'\nimport { dots } from '../TypingIndicator/index.module.css'\n\nconst Icon = id => (\n  <svg>\n    <use xlinkHref={`index.svg#${id}`} />\n  </svg>\n)\n\nconst unreads = (user, room, messages = {}) => {\n  const read = user.readCursor({ roomId: room.id })\n  return (\n    (read && Object.keys(messages).filter(x => x > read.position).length) ||\n    undefined\n  )\n}\n\nconst priority = (user, room, messages = {}) => {\n  const unreadMessages = unreads(user, room, messages) || 0\n  const lastMessage = Object.keys(messages).pop() || 0\n  return (10 * unreadMessages + parseInt(lastMessage)) * -1\n}\n\nexport const RoomList = ({\n  rooms = [],\n  user,\n  messages,\n  current,\n  typing,\n  actions,\n}) => (\n  <ul className={style.component}>\n    {rooms.map(room => {\n      const messageKeys = Object.keys(messages[room.id] || {})\n      const latestMessage =\n        messageKeys.length > 0 && messages[room.id][messageKeys.pop()]\n      const firstUser = room.users.find(x => x.id !== user.id)\n      const order = priority(user, room, messages[room.id])\n      const unreadCount = unreads(user, room, messages[room.id])\n      return (\n        <li\n          key={room.id}\n          disabled={room.id === current.id}\n          onClick={e => actions.joinRoom(room)}\n          style={{ order }}\n        >\n          {room.name.match(user.id) && firstUser ? (\n            <img src={firstUser.avatarURL} alt={firstUser.id} />\n          ) : (\n            Icon(room.isPrivate ? 'lock' : 'public')\n          )}\n          <col->\n            <p>{room.name.replace(user.id, '')}</p>\n            <span>{latestMessage && latestMessage.text}</span>\n          </col->\n          {room.id !== current.id && unreadCount ? (\n            <label>{unreadCount}</label>\n          ) : Object.keys(typing[room.id] || {}).length > 0 ? (\n            <div className={dots}>{[0, 1, 2].map(x => <div key={x} />)}</div>\n          ) : null}\n        </li>\n      )\n    })}\n  </ul>\n)\n","import React from 'react'\nimport style from './index.module.css'\n\nexport const RoomHeader = ({\n  state: { room, user, sidebarOpen, userListOpen },\n  actions: { setSidebar, setUserList },\n}) => (\n  <header className={style.component}>\n    <button onClick={e => setSidebar(!sidebarOpen)}>\n      <svg>\n        <use xlinkHref=\"index.svg#menu\" />\n      </svg>\n    </button>\n    <h1>{room.name && room.name.replace(user.id, '')}</h1>\n    {room.users && (\n      <div onClick={e => setUserList(!userListOpen)}>\n        <span>{room.users.length}</span>\n        <svg>\n          <use xlinkHref=\"index.svg#members\" />\n        </svg>\n      </div>\n    )}\n  </header>\n)\n","import React from 'react'\nimport style from './index.module.css'\n\nexport const CreateRoomForm = ({ submit }) => (\n  <form\n    className={style.component}\n    onSubmit={e => {\n      e.preventDefault()\n      submit({\n        name: e.target[0].value,\n        private: e.target.elements[2].checked,\n      })\n      e.target[0].value = ''\n    }}\n  >\n    <input placeholder=\"Create a Room\" />\n    <button>\n      <input type=\"checkbox\" />\n      <svg>\n        <use xlinkHref=\"index.svg#lock\" />\n      </svg>\n    </button>\n    <button type=\"submit\">\n      <svg>\n        <use xlinkHref=\"index.svg#add\" />\n      </svg>\n    </button>\n  </form>\n)\n","import React from 'react'\nimport style from './index.module.css'\n\nexport const WelcomeScreen = () => (\n  <section>\n    <div className={style.component}>\n      <span role=\"img\" aria-label=\"post\">\n        <svg viewBox=\"0 0 59 80\">\n          <g>\n            <path d=\"M48.417 49.444L38.585 73.229 36.012 71.394 41.802 56.726 31.211 59.519C31.211 59.519 26.022 42.42 26.513 30.837 26.218 22.744 27.644 16.96 30.167 13.6 34.274 8.408 42.099 3.953 49.793 7.645 54.701 9.869 57.658 13.889 58.107 17.824 59.479 34.859 38.498 41.817 38.498 41.817L38.085 38.191C38.085 38.191 44.945 35.464 49.105 29.553 53.266 23.643 51.245 15.88 46.569 14.464 42.061 13.577 37.34 18.757 36.516 27.966 34.721 41.776 39.393 52.006 39.393 52.006L48.417 49.444M0 62.396L15.402 74.372 16.522 71.783 8.26 65.71 16.853 63.305C16.853 63.305 10.998 47.535 10.597 32.251 10.229 27.354 9.896 11.684 15.924 8.975 16.976 7.213 18.743 5.903 18.743 5.903 18.743 5.903 3.467 4.584 4.184 32.453 5.706 51.166 9.451 59.821 9.451 59.821L0 62.396\" />\n            <path d=\"M29.91,61.761 L38.969,59.263 L30.045,80 L11.998,66.538 L19.098,64.644 C19.098,64.644 3.276,20.694 21.128,5.095 C32.325,-3.789 43.164,3.999 42.965,4.872 C40.203,4.812 37.842,5.844 37.842,5.844 C37.842,5.844 31.789,3.265 27.475,12.503 C23.719,20.705 22.048,34.474 29.91,61.761\" />\n            <path d=\"M41.806,17.606 C42.599,24.356 38.244,27.206 38.244,27.206 L37.819,30.659 C37.819,30.659 47.709,25.549 45.669,15.819 C44.566,15.913 42.212,17.242 41.806,17.606\" />\n          </g>\n        </svg>\n      </span>\n      <p>\n        Authenticating, subscribing to rooms<br />and fetching messages.\n      </p>\n    </div>\n  </section>\n)\n","import React from 'react'\nimport style from './index.module.css'\n\nexport const JoinRoomScreen = () => (\n  <section>\n    <div className={style.component}>\n      <span role=\"img\" aria-label=\"post\">\n        <svg viewBox=\"0 0 59 80\">\n          <g>\n            <path d=\"M48.417 49.444L38.585 73.229 36.012 71.394 41.802 56.726 31.211 59.519C31.211 59.519 26.022 42.42 26.513 30.837 26.218 22.744 27.644 16.96 30.167 13.6 34.274 8.408 42.099 3.953 49.793 7.645 54.701 9.869 57.658 13.889 58.107 17.824 59.479 34.859 38.498 41.817 38.498 41.817L38.085 38.191C38.085 38.191 44.945 35.464 49.105 29.553 53.266 23.643 51.245 15.88 46.569 14.464 42.061 13.577 37.34 18.757 36.516 27.966 34.721 41.776 39.393 52.006 39.393 52.006L48.417 49.444M0 62.396L15.402 74.372 16.522 71.783 8.26 65.71 16.853 63.305C16.853 63.305 10.998 47.535 10.597 32.251 10.229 27.354 9.896 11.684 15.924 8.975 16.976 7.213 18.743 5.903 18.743 5.903 18.743 5.903 3.467 4.584 4.184 32.453 5.706 51.166 9.451 59.821 9.451 59.821L0 62.396\" />\n            <path d=\"M29.91,61.761 L38.969,59.263 L30.045,80 L11.998,66.538 L19.098,64.644 C19.098,64.644 3.276,20.694 21.128,5.095 C32.325,-3.789 43.164,3.999 42.965,4.872 C40.203,4.812 37.842,5.844 37.842,5.844 C37.842,5.844 31.789,3.265 27.475,12.503 C23.719,20.705 22.048,34.474 29.91,61.761\" />\n            <path d=\"M41.806,17.606 C42.599,24.356 38.244,27.206 38.244,27.206 L37.819,30.659 C37.819,30.659 47.709,25.549 45.669,15.819 C44.566,15.913 42.212,17.242 41.806,17.606\" />\n          </g>\n        </svg>\n      </span>\n      <p>\n        Join a room, create a room or click on a user avatar and start a\n        conversation.\n      </p>\n    </div>\n  </section>\n)\n","import { ChatManager, TokenProvider } from '@pusher/chatkit-client'\n\nconst credentials = {\n  url: (accessToken) =>\n    `https://zmarkan-chatkit-sample-server.glitch.me/token?token=${accessToken}`,\n  instanceLocator: 'v1:us1:7954c374-f491-4c08-b71e-5abfc0a3dc89',\n}\n\nconst { instanceLocator, url } = credentials\nexport default ({ state, actions }, { id, accessToken }) => {   \n\n  console.log(`id: ${id}`)\n  new ChatManager({\n    tokenProvider: new TokenProvider({ url: url(accessToken) }),\n    instanceLocator,\n    userId: id,\n  })\n    .connect({\n      onUserStartedTyping: actions.isTyping,\n      onUserStoppedTyping: actions.notTyping,\n      onAddedToRoom: actions.subscribeToRoom,\n      onRemovedFromRoom: actions.removeRoom,\n      onUserCameOnline: actions.setUserPresence,\n      onUserWentOffline: actions.setUserPresence,\n    })\n    .then(user => {\n      // Subscribe to all rooms the user is a member of\n\n      console.log(\"subscribe to rooms\")\n\n      Promise.all(\n        user.rooms.map(room => {\n          \n          console.log(room)\n\n          return user.subscribeToRoom({\n            roomId: room.id,\n            hooks: { onMessage: actions.addMessage },\n          })\n        })\n      ).then(rooms => {\n        console.log(rooms)\n        actions.setUser(user)\n        // Join the first room in the users room list\n        user.rooms.length > 0 && actions.joinRoom(user.rooms[0])\n      })\n    })\n    .catch(error => console.log('Error on connection', error))\n\n  }","import createHistory from 'history/createBrowserHistory'\nexport default createHistory()","import auth0 from \"auth0-js\";\nimport history from \"../history\"\nimport jwtdecode from \"jwt-decode\"\n\nexport default class Auth {\n\n  auth0 = new auth0.WebAuth({\n    domain: 'pusher-chatkit-demo.auth0.com',\n    clientID: 'VF0kHM9szMj0aQGEfqafrdAKVwRb2a3Q',\n    redirectUri: \"https://zmarkan.github.io/chatkit-sample-client/callback\",\n    responseType: \"token id_token\",\n    scope: \"openid email profile\"\n  });\n\n  constructor() {\n    this.login = this.login.bind(this)\n    this.logout = this.logout.bind(this)\n    this.handleAuthentication = this.handleAuthentication.bind(this)\n    this.isAuthenticated = this.isAuthenticated.bind(this)\n    this.getAuthToken = this.getAuthToken.bind(this)\n    this.getUserId = this.getUserId.bind(this)\n  }\n\n  handleAuthentication(callback) {\n    this.auth0.parseHash((err, authResult) => {\n\n        if (authResult && authResult.accessToken && authResult.idToken) {\n            this.setSession(authResult);\n            const email = this.getUserId(authResult.idToken)\n            callback(authResult, email)\n        } else if (err) {\n          history.replace('/error');\n          console.log(err);\n          alert(`Error: ${err.error}. Check the console for further details.`);\n        }\n      });  \n    }\n\n  setSession(authResult) {\n    // Set the time that the access token will expire at\n    let expiresAt = JSON.stringify((authResult.expiresIn * 1000) + new Date().getTime())\n    localStorage.setItem('access_token', authResult.accessToken)\n    localStorage.setItem('id_token', authResult.idToken)\n    localStorage.setItem('expires_at', expiresAt)\n\n    const idToken = jwtdecode(authResult.idToken)\n    const email = idToken.email\n    localStorage.setItem('chatkit_user', email)\n    console.log(\"SET SESSION\")\n  }\n\n  logout() {\n    // Clear Access Token and ID Token from local storage\n    localStorage.removeItem('access_token')\n    localStorage.removeItem('id_token')\n    localStorage.removeItem('expires_at')\n    localStorage.removeItem('chatkit_user')\n    // navigate to the home route\n    // history.replace('/home');s\n  }\n\n  isAuthenticated() {\n    // Check whether the current time is past the \n    // Access Token's expiry time\n    let expiresAt = JSON.parse(localStorage.getItem('expires_at'));\n    return new Date().getTime() < expiresAt;\n  }\n\n  login() {\n    this.auth0.authorize();    \n  }\n\n  getAuthToken() {\n    return localStorage.getItem('access_token')\n  }\n\n  getUserId(idToken) { //Unsafe, not verified\n      return jwtdecode(idToken).email\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { set, del } from 'object-path-immutable'\nimport { version } from '../package.json'\nimport './index.css'\n\nimport { UserHeader } from './components/UserHeader'\nimport { UserList } from './components/UserList'\nimport { MessageList } from './components/MessageList'\nimport { TypingIndicator } from './components/TypingIndicator'\nimport { CreateMessageForm } from './components/CreateMessageForm'\nimport { RoomList } from './components/RoomList'\nimport { RoomHeader } from './components/RoomHeader'\nimport { CreateRoomForm } from './components/CreateRoomForm'\nimport { WelcomeScreen } from './components/WelcomeScreen'\nimport { JoinRoomScreen } from './components/JoinRoomScreen'\n\nimport ChatManager from './chatkit'\n\nimport Auth from './auth/auth'\nimport { Route, Router } from 'react-router-dom'\nimport history from './history'\n\n// --------------------------------------\n// Application\n// --------------------------------------\n\nclass Main extends React.Component {\n  state = {\n    user: {},\n    room: {},\n    messages: {},\n    typing: {},\n    sidebarOpen: false,\n    userListOpen: window.innerWidth > 1000,\n  }\n\n  actions = {\n    // --------------------------------------\n    // UI\n    // --------------------------------------\n\n    setSidebar: sidebarOpen => this.setState({ sidebarOpen }),\n    setUserList: userListOpen => this.setState({ userListOpen }),\n\n    // --------------------------------------\n    // User\n    // --------------------------------------\n\n    setUser: user => this.setState({ user }),\n\n    // --------------------------------------\n    // Room\n    // --------------------------------------\n\n    setRoom: room => {\n      this.setState({ room, sidebarOpen: false })\n      this.actions.scrollToEnd()\n    },\n\n    removeRoom: room => this.setState({ room: {} }),\n\n    joinRoom: room => {\n      this.actions.setRoom(room)\n      this.actions.subscribeToRoom(room)\n      this.state.messages[room.id] &&\n        this.actions.setCursor(\n          room.id,\n          Object.keys(this.state.messages[room.id]).pop()\n        )\n    },\n\n    subscribeToRoom: room =>\n      !this.state.user.roomSubscriptions[room.id] &&\n      this.state.user.subscribeToRoom({\n        roomId: room.id,\n        hooks: { onMessage: this.actions.addMessage },\n      }),\n\n    createRoom: options =>\n      this.state.user.createRoom(options).then(this.actions.joinRoom),\n\n    createConvo: options => {\n      if (options.user.id !== this.state.user.id) {\n        const exists = this.state.user.rooms.find(\n          x =>\n            x.name === options.user.id + this.state.user.id ||\n            x.name === this.state.user.id + options.user.id\n        )\n        exists\n          ? this.actions.joinRoom(exists)\n          : this.actions.createRoom({\n              name: this.state.user.id + options.user.id,\n              addUserIds: [options.user.id],\n              private: true,\n            })\n      }\n    },\n\n    addUserToRoom: ({ userId, roomId = this.state.room.id }) =>\n      this.state.user\n        .addUserToRoom({ userId, roomId })\n        .then(this.actions.setRoom),\n\n    removeUserFromRoom: ({ userId, roomId = this.state.room.id }) =>\n      userId === this.state.user.id\n        ? this.state.user.leaveRoom({ roomId })\n        : this.state.user\n            .removeUserFromRoom({ userId, roomId })\n            .then(this.actions.setRoom),\n\n    // --------------------------------------\n    // Cursors\n    // --------------------------------------\n\n    setCursor: (roomId, position) =>\n      this.state.user\n        .setReadCursor({ roomId, position: parseInt(position) })\n        .then(x => this.forceUpdate()),\n\n    // --------------------------------------\n    // Messages\n    // --------------------------------------\n\n    addMessage: payload => {\n\n      console.log(\"addMessage\")\n      console.log(payload)\n\n      const roomId = payload.room.id\n      const messageId = payload.id\n      // Update local message cache with new message\n      this.setState(set(this.state, ['messages', roomId, messageId], payload))\n      // Update cursor if the message was read\n      if (roomId === this.state.room.id) {\n        const cursor = this.state.user.readCursor({ roomId }) || {}\n        const cursorPosition = cursor.position || 0\n        cursorPosition < messageId && this.actions.setCursor(roomId, messageId)\n        this.actions.scrollToEnd()\n      }\n      // Send notification\n      this.actions.showNotification(payload)\n    },\n\n    runCommand: command => {\n      const commands = {\n        invite: ([userId]) => this.actions.addUserToRoom({ userId }),\n        remove: ([userId]) => this.actions.removeUserFromRoom({ userId }),\n        leave: ([userId]) =>\n          this.actions.removeUserFromRoom({ userId: this.state.user.id }),\n      }\n      const name = command.split(' ')[0]\n      const args = command.split(' ').slice(1)\n      const exec = commands[name]\n      exec && exec(args).catch(console.log)\n    },\n\n    scrollToEnd: e =>\n      setTimeout(() => {\n        const elem = document.querySelector('#messages')\n        elem && (elem.scrollTop = 100000)\n      }, 0),\n\n    // --------------------------------------\n    // Typing Indicators\n    // --------------------------------------\n\n    isTyping: (room, user) =>\n      this.setState(set(this.state, ['typing', room.id, user.id], true)),\n\n    notTyping: (room, user) =>\n      this.setState(del(this.state, ['typing', room.id, user.id])),\n\n    // --------------------------------------\n    // Presence\n    // --------------------------------------\n\n    setUserPresence: () => this.forceUpdate(),\n\n    // --------------------------------------\n    // Notifications\n    // --------------------------------------\n\n    showNotification: message => {\n      if (\n        'Notification' in window &&\n        this.state.user.id &&\n        this.state.user.id !== message.senderId &&\n        document.visibilityState === 'hidden'\n      ) {\n        const notification = new Notification(\n          `New Message from ${message.sender.id}`,\n          {\n            body: message.text,\n            icon: message.sender.avatarURL,\n          }\n        )\n        notification.addEventListener('click', e => {\n          this.actions.joinRoom(message.room)\n          window.focus()\n        })\n      }\n    },\n  }\n\n  componentDidMount() {\n\n    if(auth.isAuthenticated){\n\n      'Notification' in window && Notification.requestPermission()\n    \n      let userId = localStorage.getItem('chatkit_user')\n\n      let existingUser = { \n        id: userId, \n        accessToken: localStorage.getItem('access_token') \n      }\n\n      ChatManager(this, existingUser)\n    }\n    else{\n      console.log(\"Not authenticated, we should probably handle this lol\")\n    }\n  }\n\n  render() {\n    const {\n      user,\n      room,\n      messages,\n      typing,\n      sidebarOpen,\n      userListOpen,\n    } = this.state\n    const { createRoom, createConvo, removeUserFromRoom } = this.actions\n\n    console.log(`Authenticated: ${auth.isAuthenticated()}`)\n    if(!auth.isAuthenticated()) this.props.auth.login()\n\n    return (\n      <main>\n        <aside data-open={sidebarOpen}>\n          <UserHeader user={user} />\n          <RoomList\n            user={user}\n            rooms={user.rooms}\n            messages={messages}\n            typing={typing}\n            current={room}\n            actions={this.actions}\n          />\n          {user.id && <CreateRoomForm submit={createRoom} />}\n        </aside>\n        <section>\n          <RoomHeader state={this.state} actions={this.actions} />\n          {room.id ? (\n            <row->\n              <col->\n                <MessageList\n                  user={user}\n                  messages={messages[room.id]}\n                  createConvo={createConvo}\n                />\n                <TypingIndicator typing={typing[room.id]} />\n                <CreateMessageForm state={this.state} actions={this.actions} />\n              </col->\n              {userListOpen && (\n                <UserList\n                  room={room}\n                  current={user.id}\n                  createConvo={createConvo}\n                  removeUser={removeUserFromRoom}\n                />\n              )}\n            </row->\n          ) : user.id ? (\n            <JoinRoomScreen />\n          ) : (\n            <WelcomeScreen />\n          )}\n        </section>\n      </main>\n    )\n  }\n}\n\nclass Callback extends  React.Component {\n\n  render() {\n    const style = {\n      position: 'absolute',\n      display: 'flex',\n      justifyContent: 'center',\n      height: '100%',\n      width: '100%',\n      top: 0,\n      bottom: 0,\n      left: 0,\n      right: 0,\n      backgroundColor: 'white',\n\n    }\n    return (\n      <div style={style}>\n        <svg>\n          <use xlinkHref=\"loading.svg\" />\n        </svg>\n      </div>\n    );\n  }\n\n  componentDidMount() {\n    handleAuthentication(\n      this.props, \n      (accessToken, userId) => {\n        history.replace('/')\n      });\n  }\n\n}\n// --------------------------------------\n// Authentication\n// --------------------------------------\n\nconst auth = new Auth()\n\nconst handleAuthentication = ({location}, callback) => {\n  if (/access_token|id_token|error/.test(location.hash)) {\n    auth.handleAuthentication(callback);\n  }\n}\n\nexport const makeMainRoutes = () => {\n  return (\n    <Router history={history}>\n        <div>\n          <Route path=\"/\" render={(props) => <Main auth={auth} {...props} />} />\n          <Route path=\"/callback\" render={(props) => <Callback {...props} /> }/>\n        </div>\n    </Router>\n  )\n}\n\nconst routes = makeMainRoutes();\nReactDOM.render(\n  routes,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}